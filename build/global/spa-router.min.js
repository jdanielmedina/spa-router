!function(t){t(window)}(function(t){function r(t){for(var r=_.listeners,n=0,e=r.length;e>n;n++)r[n](t)}function n(t){var r,n=this.options.mode;switch(n){case"history":r=h.pathname+h.search+h.hash,"/"!==r.substr(0,1)&&(r="/"+r);break;case"hashbang":default:var e=h.hash.slice(1);if(""===e||"!"===e)return this.redirect(this.options.root);var i=t&&t.newURL||h.hash;r=i.replace(/.*#!/,"")}this.dispatch("/"===r.charAt(0)?r:"/"+r)}function e(t,r,n){n=!!n;for(var e,i=r.split("/"),s=null,a=!1,o=t,h=0,l=i.length;l>h;++h){e=!1;var c=i[h],u=/:([a-zA-Z_][a-zA-Z0-9_]*)(\([^\)]+\))?/g,f=0;c=c.replace(u,function(t,r,n){return e=e||[],e[f++]=r,"undefined"==typeof n?"([a-zA-Z0-9_]+)":n});for(var p=0;p<o._children.length;++p)if(o._children[p].value===c){s=o._children[p],a=!0;break}if(!a){if(n)return!1;var d=new m(c);o.children(d),d.parent(o),d.params=e,s=d}o=s,a=!1}return s}function i(t,r){if(v(r))return t.callbacks=[r],t;if(d(r))return t.callbacks=r,t;for(var n in r)if(p.call(r,n)){var s=r[n];"/"===n?i(t,s):(""!==n&&"/"===n[0]&&(n=n.slice(1)),i(e(t,n),s))}return t}function s(t,r,n,e,i){var a=r[n],o={};for(var h in i)p.call(i,h)&&(o[h]=i[h]);var l=t.parent();if(null===l&&e>0)return[!1,o];if(null!==l&&e>l._children.length-1)return[!1,o];if(n>r.length-1||0>n)return[!1,o];var c=new RegExp("^"+t.value+"$"),u=a.match(c);if(null===u)return[!1,o];if(t.params){u=[].slice.apply(u,[1]);for(var f=0;f<u.length;++f)o[t.params[f]]=u[f]}if(n===r.length-1&&null!==t.callbacks)return[t,o];for(var d=0;d<t._children.length;++d){var v=s(t._children[d],r,n+1,d,o);if(v[0])return v}return s(t,r,n,e+1,i)}function a(t,r){var n=s(t,r.split("/"),0,0,{});return n[0]?[n[0].callbacks,n[1]]:[null,{}]}var o=window,h=o.location,l=Object.prototype.toString,c=o.decodeURIComponent,u=o.encodeURIComponent,f="undefined",p=Object.prototype.hasOwnProperty,d=function(t){return"[object Array]"===l.call(t)},v=function(t){return"[object Function]"===l.call(t)},y=function(){for(var t={},r=[].slice.call(arguments,0),n=0,e=r.length;e>n;++n){var i=r[n];for(var s in i)p.call(i,s)&&(t[s]=i[s])}return t},g=function(t,r){o.addEventListener?o.addEventListener(t,r,!1):o.attachEvent?o.attachEvent("on"+t,r):o["on"+t]=r},b={parse:function(t){if("string"!=typeof t)return{};if(t=t.replace(/^\s*|\s*$/g,"").replace(/^(\?|#)/,""),!t)return{};for(var r=t.split("&"),n={},e=0,i=r.length;i>e;++e){var s=r[e].replace(/\+/g," ").split("="),a=s[0],o=s[1];a=c(a),o=void 0===o?null:c(o),p.call(n,a)?d(n[a])?n[a].push(o):n[a]=[n[a],o]:n[a]=o}return n},stringify:function(t){if(!t)return"";var r=[];for(var n in t)p.call(t,n)&&r.push(n);r.sort();for(var e=[],i=0,s=r.length;s>i;++i){var a=r[i],o=t[a];if(d(o)){o.sort();for(var h=[],l=0,c=o.length;c>l;++l)h.push(u(a)+"="+u(o[l]));e.push(h.join("&"))}else e.push(u(a)+"="+u(o))}return e.join("&")}},m=function(t){if(typeof t===f)throw new TypeError("The RNode Constructor Need A Value.");this.value=t,this.params={},this.callbacks=null,this.before=null,this.after=null,this._children=[],this._parent=null},w=m.prototype;w.children=function(t){return typeof t===f?this._children:(t instanceof m?this._children.push(t):d(t)&&(this._children=this.children.concat(t)),this)},w.parent=function(t){return typeof t===f?this._parent:(t instanceof m&&(this._parent=t),this)};var k=typeof o.history.pushState!==f,_={listeners:null,history:!1,init:function(t){return this.history="history"===t,this.history&&k?g("popstate",r):g("hashchange",r),this},add:function(t){return this.listeners||(this.listeners=[]),this.listeners.push(t),this},setHashHistory:function(t){if(this.history)history.pushState({},document.title,t);else if("/"===t[0])h.hash="!"+t;else{var r=h.hash.slice(2),n=r.indexOf("?");if(-1!==n&&(r=r.slice(0,n)),/.*\/$/.test(r))h.hash="!"+r+t;else{var e=r.replace(/([^\/]+|)$/,function(r){return""===r?"/"+t:t});h.hash="!"+e}}return this}},R={root:"/",mode:"hashbang",notFound:!1,recurse:!1},T=t.Router=function(t){if(t=t||{},!(this instanceof T))return new T(t);var r=new m("");r.params=!1,this.routeTree=i(r,t),this.options={},this.configure(R)},E=T.prototype;E.configure=function(t){return t=t||{},this.options=y(this.options,t),this},E.start=function(t){t=t||{};var r=this;return this.configure(t),_.init(this.options.mode).add(function(){return n.call(r)}),n.call(this),this},E.mount=function(t,r){return""!==t&&"/"===t[0]&&(t=t.slice(1)),i(e(this.routeTree,t),r),this},E.on=function(t,r){""!==t&&"/"===t[0]&&(t=t.slice(1));var n=e(this.routeTree,t);return n.callbacks=n.callbacks||[],d(r)?n.callbacks=n.callbacks.concat(r):v(r)&&n.callbacks.push(r),this},E.dispatch=function(t){var r=this.routeTree,n=t,e=t.indexOf("?"),i=t.indexOf("#");i=-1===i?t.length:i;var s=-1===e?"":t.slice(e+1,i);t=-1===e?t:t.slice(0,e);var o={uri:n,path:t,query:b.parse(s)};"/"===t&&(t="");var h=a(r,t),l=h[0];if(o.params=h[1],null!==l){if(!d(l))throw new TypeError("callbacks must be an array type");for(var c=0,u=l.length;u>c;++c)l[c].call(this,o)}else this.options.notFound&&this.options.notFound(o);return this},E.setRoute=function(t){var r=window.location,n=r.pathname+r.search;_.setHashHistory(t);var e=r.pathname+r.search;return"history"===this.options.mode&&n!==e&&this.dispatch(e),this},E.redirect=E.setRoute,E.once=function(t,r){return this},E.off=function(t){""!==t&&"/"===t[0]&&(t=t.slice(1));var r=e(this.routeTree,t);return null!==r&&null!==r.callbacks&&r.callbacks.splice(0,r.callbacks.length),this},E.reload=function(){var t=window.location;return"history"===this.options.mode?this.dispatch(t.pathname+t.search+t.hash):this.dispatch(t.hash.slice(1)),this}});
//# sourceMappingURL=spa-router.min.js.map