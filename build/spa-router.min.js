!function(t){"function"==typeof define&&define.cmd?define(function(n,e,r){t(e)}):t(window)}(function(t){function n(t){for(var n=b.listeners,e=0,r=n.length;r>e;e++)n[e](t)}function e(t,n,e){e=!!e;for(var r,i=n.split("/"),a=null,s=!1,o=t,l=0,c=i.length;c>l;++l){r=!1;var h=i[l],u=/:([a-zA-Z_][a-zA-Z0-9_]*)(\([^\)]+\))?/g,f=0;h=h.replace(u,function(t,n,e){return r=r||[],r[f++]=n,"undefined"==typeof e?"([a-zA-Z0-9_]+)":e});for(var p=0;p<o._children.length;++p)if(o._children[p].value===h){a=o._children[p],s=!0;break}if(!s){if(e)return!1;var d=new y(h);o.children(d),d.parent(o),d.params=r,a=d}o=a,s=!1}return a}function r(t,n){if(f(n))return t.callbacks=[n],t;if(u(n))return t.callbacks=n,t;for(var i in n)if(h.call(n,i)){var a=n[i];"/"===i?r(t,a):(""!==i&&"/"===i[0]&&(i=i.slice(1)),r(e(t,i),a))}return t}function i(t,n,e,r,a){var s=n[e],o={};for(var l in a)h.call(a,l)&&(o[l]=a[l]);var c=t.parent();if(null===c&&r>0)return[!1,o];if(null!==c&&r>c._children.length-1)return[!1,o];if(e>n.length-1||0>e)return[!1,o];var u=new RegExp("^"+t.value+"$"),f=s.match(u);if(null===f)return[!1,o];if(t.params){f=[].slice.apply(f,[1]);for(var p=0;p<f.length;++p)o[t.params[p]]=f[p]}if(e===n.length-1&&null!==t.callbacks)return[t,o];for(var d=0;d<t._children.length;++d){var v=i(t._children[d],n,e+1,d,o);if(v[0])return v}return i(t,n,e,r+1,a)}function a(t,n){var e=i(t,n.split("/"),0,0,{});return e[0]?[e[0].callbacks,e[1]]:[null,{}]}var s=window,o=Object.prototype.toString,l=s.decodeURIComponent,c=s.encodeURIComponent,h=Object.prototype.hasOwnProperty,u=function(t){return"[object Array]"===o.call(t)},f=function(t){return"[object Function]"===o.call(t)},p=function(){for(var t={},n=[].slice.call(arguments,0),e=0,r=n.length;r>e;++e){var i=n[e];for(var a in i)h.call(i,a)&&(t[a]=i[a])}return t},d=function(t,n){s.addEventListener?s.addEventListener(t,n,!1):s.attachEvent?s.attachEvent("on"+t,n):s["on"+t]=n},v={parse:function(t){if("string"!=typeof t)return{};if(t=t.replace(/^\s*|\s*$/g,"").replace(/^(\?|#)/,""),!t)return{};for(var n=t.split("&"),e={},r=0,i=n.length;i>r;++r){var a=n[r].replace(/\+/g," ").split("="),s=a[0],o=a[1];s=l(s),o=void 0===o?null:l(o),h.call(e,s)?u(e[s])?e[s].push(o):e[s]=[e[s],o]:e[s]=o}return e},stringify:function(t){if(!t)return"";var n=[];for(var e in t)h.call(t,e)&&n.push(e);n.sort();for(var r=[],i=0,a=n.length;a>i;++i){var s=n[i],o=t[s];if(u(o)){o.sort();for(var l=[],f=0,p=o.length;p>f;++f)l.push(c(s)+"="+c(o[f]));r.push(l.join("&"))}else r.push(c(s)+"="+c(o))}return r.join("&")}},y=function(t){if("undefined"==typeof t)throw new TypeError("The RNode Constructor Need A Value.");this.value=t,this.params={},this.callbacks=null,this.before=null,this.after=null,this._children=[],this._parent=null},g=y.prototype;g.children=function(t){return"undefined"==typeof t?this._children:(t instanceof y?this._children.push(t):u(t)&&(this._children=this.children.concat(t)),this)},g.parent=function(t){return"undefined"==typeof t?this._parent:(t instanceof y&&(this._parent=t),this)};var w="undefined"!=typeof s.history,b={listeners:null,history:!1,init:function(t){return this.history="history"===t,this.history&&w?d("popstate",n):d("hashchange",n),this},add:function(t){return this.listeners||(this.listeners=[]),this.listeners.push(t),this},setHashHistory:function(t){if(this.history)history.pushState({},document.title,t);else if("/"===t[0])s.location.hash=t;else{var n=s.location.hash,e=n.indexOf("?");if(-1!==e&&(n=n.slice(0,e)),/.*\/$/.test(n))s.location.hash=n+t;else{var r=n.replace(/([^\/]+|)$/,function(n){return""===n?"/"+t:t});s.location.hash=r}}return this}},m={mode:"default",notFound:!1,always:!1,on:!1,before:!1,after:!1,recurse:!1},k=t.Router=function(t){if(t=t||{},!(this instanceof k))return new k(t);var n=new y("");n.params=!1,this.routeTree=r(n,t),this.options={},this.configure(m)},_=k.prototype;_.configure=function(t){return t=t||{},this.options=p(this.options,t),this},_.init=function(t){t=t||{};var n=this;return this.configure(t),this.handler=function(t){var e,r=t&&t.newURL||window.location.hash;switch(n.options.mode){case"history":e=window.location.pathname+window.location.search+window.location.hash,"/"!==e.substr(0,1)&&(e="/"+e);break;case"hashbang":e=r.replace(/.*#!/,"");break;default:e=r.replace(/.*#/,"")}n.dispatch("/"===e.charAt(0)?e:"/"+e)},b.init(this.options.mode).add(this.handler),this.handler(),this},_.mount=function(t,n){return""!==t&&"/"===t[0]&&(t=t.slice(1)),r(e(this.routeTree,t),n),this},_.on=_.route=function(t,n){""!==t&&"/"===t[0]&&(t=t.slice(1));var r=e(this.routeTree,t);return r.callbacks=r.callbacks||[],u(n)?r.callbacks=r.callbacks.concat(n):f(n)&&r.callbacks.push(n),this},_.dispatch=function(t){var n=this.routeTree,e=t,r=t.indexOf("?"),i=t.indexOf("#");i=-1===i?t.length:i;var s=-1===r?"":t.slice(r+1,i);t=-1===r?t:t.slice(0,r);var o={uri:e,path:t,query:v.parse(s)};"/"===t&&(t="");var l=a(n,t),c=l[0];if(o.params=l[1],null!==c){if(!u(c))throw new TypeError("callbacks must be an array type");for(var h=0,f=c.length;f>h;++h)c[h].call(this,o)}else this.options.notFound&&this.options.notFound(o);return this},_.setRoute=function(t){var n=window.location,e=n.pathname+n.search;b.setHashHistory(t);var r=n.pathname+n.search;return"history"===this.options.mode&&e!==r&&this.dispatch(r),this},_.redirect=_.setRoute,_.once=function(t,n){return this},_.off=function(t){""!==t&&"/"===t[0]&&(t=t.slice(1));var n=e(this.routeTree,t);return null!==n&&null!==n.callbacks&&n.callbacks.splice(0,n.callbacks.length),this},_.reload=function(){var t=window.location;return this.dispatch("history"===this.options.mode?t.pathname+t.search+t.hash:t.hash.slice(1)),this}});
//# sourceMappingURL=spa-router.min.js.map