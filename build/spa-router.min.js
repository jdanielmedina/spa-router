/* spa-router by zcoding 2015-07-01 version: 0.4.2 */
!function(a){"function"==typeof define&&define.cmd?define(function(require,exports,module){a(exports)}):a(window)}(function(exports){function a(a){for(var b=r.listeners,c=0,d=b.length;d>c;c++)b[c](a)}function b(a,b,c){c=!!c;for(var d,e=b.split("/"),f=null,g=!1,h=a,i=0,j=e.length;j>i;++i){d=!1;var k=e[i],l=/:([a-zA-Z_][a-zA-Z0-9_]*)(\([^\)]+\))?/g,m=0;k=k.replace(l,function(a,b,c){return d=d||[],d[m++]=b,"undefined"==typeof c?"([a-zA-Z0-9_]+)":c});for(var n=0;n<h._children.length;++n)if(h._children[n].value===k){f=h._children[n],g=!0;break}if(!g){if(c)return!1;var p=new o(k);h.children(p),p.parent(h),p.params=d,f=p}h=f,g=!1}return f}function c(a,d){if(k(d))return a.callbacks=[d],a;if(j(d))return a.callbacks=d,a;for(var e in d)if(i.call(d,e)){var f=d[e];"/"===e?c(a,f):(""!==e&&"/"===e[0]&&(e=e.slice(1)),c(b(a,e),f))}return a}function d(a,b,c,e,f){var g=b[c],h={};for(var j in f)i.call(f,j)&&(h[j]=f[j]);var k=a.parent();if(null===k&&e>0)return[!1,h];if(null!==k&&e>k._children.length-1)return[!1,h];if(c>b.length-1||0>c)return[!1,h];var l=new RegExp("^"+a.value+"$"),m=g.match(l);if(null===m)return[!1,h];if(a.params){m=[].slice.apply(m,[1]);for(var n=0;n<m.length;++n)h[a.params[n]]=m[n]}if(c===b.length-1&&null!==a.callbacks)return[a,h];for(var o=0;o<a._children.length;++o){var p=d(a._children[o],b,c+1,o,h);if(p[0])return p}return d(a,b,c,e+1,f)}function e(a,b){var c=d(a,b.split("/"),0,0,{});return c[0]?[c[0].callbacks,c[1]]:[null,{}]}var f=Object.prototype.toString,g=window.decodeURIComponent,h=window.encodeURIComponent,i=Object.prototype.hasOwnProperty,j=function(a){return"[object Array]"===f.call(a)},k=function(a){return"[object Function]"===f.call(a)},l=function(){for(var a={},b=[].slice.call(arguments,0),c=0,d=b.length;d>c;++c){var e=b[c];for(var f in e)i.call(e,f)&&(a[f]=e[f])}return a},m=function(a,b){window.addEventListener?window.addEventListener(a,b,!1):window.attachEvent?window.attachEvent("on"+a,b):window["on"+a]=b},n={parse:function(a){if("string"!=typeof a)return{};if(a=a.replace(/^\s*|\s*$/g,"").replace(/^(\?|#)/,""),!a)return{};for(var b=a.split("&"),c={},d=0,e=b.length;e>d;++d){var f=b[d].replace(/\+/g," ").split("="),h=f[0],k=f[1];h=g(h),k=void 0===k?null:g(k),i.call(c,h)?j(c[h])?c[h].push(k):c[h]=[c[h],k]:c[h]=k}return c},stringify:function(a){if(!a)return"";var b=[];for(var c in a)i.call(a,c)&&b.push(c);b.sort();for(var d=[],e=0,f=b.length;f>e;++e){var g=b[e],k=a[g];if(j(k)){k.sort();for(var l=[],m=0,n=k.length;n>m;++m)l.push(h(g)+"="+h(k[m]));d.push(l.join("&"))}else d.push(h(g)+"="+h(k))}return d.join("&")}},o=function(a){if("undefined"==typeof a)throw new TypeError("The RNode Constructor Need A Value.");this.value=a,this.params={},this.callbacks=null,this.before=null,this.after=null,this._children=[],this._parent=null},p=o.prototype;p.children=function(a){return"undefined"==typeof a?this._children:(a instanceof o?this._children.push(a):j(a)&&(this._children=this.children.concat(a)),this)},p.parent=function(a){return"undefined"==typeof a?this._parent:(a instanceof o&&(this._parent=a),this)};var q="undefined"!=typeof window.history,r={listeners:null,history:!1,init:function(b){return this.history="history"===b,this.history&&q?m("popstate",a):m("hashchange",a),this},add:function(a){return this.listeners||(this.listeners=[]),this.listeners.push(a),this},setHashHistory:function(a){if(this.history)history.pushState({},document.title,a);else if("/"===a[0])window.location.hash=a;else{var b=window.location.hash,c=b.indexOf("?");if(-1!==c&&(b=b.slice(0,c)),/.*\/$/.test(b))window.location.hash=b+a;else{var d=b.replace(/([^\/]+|)$/,function(b){return""===b?"/"+a:a});window.location.hash=d}}return this}},s={mode:"default",notFound:!1,always:!1,on:!1,before:!1,after:!1,recurse:!1},t=exports.Router=function(a){if(a=a||{},!(this instanceof t))return new t(a);var b=new o("");b.params=!1,this.routeTree=c(b,a),this.options={},this.configure(s)},u=t.prototype;u.configure=function(a){return a=a||{},this.options=l(this.options,a),this},u.init=function(a){a=a||{};var b=this;return this.configure(a),this.handler=function(a){var c,d=a&&a.newURL||window.location.hash;switch(b.options.mode){case"history":c=window.location.pathname+window.location.search+window.location.hash,"/"!==c.substr(0,1)&&(c="/"+c);break;case"hashbang":c=d.replace(/.*#!/,"");break;default:c=d.replace(/.*#/,"")}b.dispatch("/"===c.charAt(0)?c:"/"+c)},r.init(this.options.mode).add(this.handler),this.handler(),this},u.mount=function(a,d){return""!==a&&"/"===a[0]&&(a=a.slice(1)),c(b(this.routeTree,a),d),this},u.on=u.route=function(a,c){""!==a&&"/"===a[0]&&(a=a.slice(1));var d=b(this.routeTree,a);return d.callbacks=d.callbacks||[],j(c)?d.callbacks=d.callbacks.concat(c):k(c)&&d.callbacks.push(c),this},u.dispatch=function(a){var b=this.routeTree,c=a,d=a.indexOf("?"),f=a.indexOf("#");f=-1===f?a.length:f;var g=-1===d?"":a.slice(d+1,f);a=-1===d?a:a.slice(0,d);var h={uri:c,path:a,query:n.parse(g)};"/"===a&&(a="");var i=e(b,a),k=i[0];if(h.params=i[1],null!==k){if(!j(k))throw new TypeError("callbacks must be an array type");for(var l=0,m=k.length;m>l;++l)k[l].call(this,h)}else this.options.notFound&&this.options.notFound(h);return this},u.setRoute=function(a){var b=window.location,c=b.pathname+b.search;r.setHashHistory(a);var d=b.pathname+b.search;return"history"===this.options.mode&&c!==d&&this.dispatch(d),this},u.redirect=u.setRoute,u.once=function(a,b){return this},u.off=function(a){""!==a&&"/"===a[0]&&(a=a.slice(1));var c=b(this.routeTree,a);return null!==c&&null!==c.callbacks&&c.callbacks.splice(0,c.callbacks.length),this},u.reload=function(){var a=window.location;return this.dispatch("history"===this.options.mode?a.pathname+a.search+a.hash:a.hash.slice(1)),this}});
//# sourceMappingURL=spa-router.min.map