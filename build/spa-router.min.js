/* spa-router by zcoding 2015-05-18 version: 0.2.0 */
!function(a){"function"==typeof define&&define.cmd?define(function(require,exports,module){a(exports)}):a(window)}(function(exports){function a(a){for(var b=r.listeners,c=0,d=b.length;d>c;c++)b[c](a)}function b(a,b){for(var c,d=b.split("/"),e=null,f=!1,g=a,h=0,i=d.length;i>h;++h){c={};var j=d[h],k=new RegExp(":([a-zA-Z_][a-zA-Z0-9_]*)","g");j=j.replace(k,"([a-zA-Z0-9_]+)");var l=d[h].match(k);if(null!==l)for(var m=0;m<l.length;++m)c[m]=l[m].slice(1);else c=!1;for(var n=0;n<g._children.length;++n)if(g._children[n].value===j){e=g._children[n],f=!0;break}if(!f){var p=new o(j);g.children(p),p.parent(g),p.params=c,e=p}g=e,f=!1}return e}function c(a,d){if(l(d))return a.callbacks=[d],a;if(k(d))return a.callbacks=d,a;for(var e in d)if(d.hasOwnProperty(e)){var f=d[e];"/"===e?c(a,f):(""!==e&&"/"===e[0]&&(e=e.slice(1)),c(b(a,e),f))}return a}function d(a,b,c,e,f){var g=b[c],h={};for(var i in f)f.hasOwnProperty(i)&&(h[i]=f[i]);var j=a.parent();if(null===j&&e>0)return[!1,h];if(null!==j&&e>j._children.length-1)return[!1,h];if(c>b.length-1||0>c)return[!1,h];var k=new RegExp("^"+a.value+"$"),l=g.match(k);if(null===l)return[!1,h];if(a.params){l=[].slice.apply(l,[1]);for(var m=0;m<l.length;++m)h[a.params[m]]=l[m]}if(c===b.length-1&&null!==a.callbacks)return[a,h];for(var n=0;n<a._children.length;++n){var o=d(a._children[n],b,c+1,n,h);if(o[0])return o}return d(a,b,c,e+1,f)}function e(a,b){var c=d(a,b.split("/"),0,0,{});return c[0]?[c[0].callbacks,c[1]]:[null,{}]}var f=Object.prototype.toString,g=Object.prototype.hasOwnProperty,h=window.decodeURIComponent,i=window.encodeURIComponent,j=function(a){return this.hasOwnProperty(a)},k=function(a){return"[object Array]"===f.call(a)},l=function(a){return"[object Function]"===f.call(a)},m=function(){for(var a={},b=[].slice.call(arguments,0),c=0,d=b.length;d>c;++c){var e=b[c];for(var f in e)j.call(e,f)&&(a[f]=e[f])}return a},n={parse:function(a){if("string"!=typeof a)return{};if(a=a.trim().replace(/^(\?|#)/,""),!a)return{};a=a.replace(/^\s*|\s*$/g,"");for(var b=a.split("&"),c={},d=0,e=b.length;e>d;++d){var f=b[d].replace(/\+/g," ").split("="),g=f[0],i=f[1];g=h(g),i=void 0===i?null:h(i),j.call(c,g)?k(c[g])?c[g].push(i):c[g]=[c[g],i]:c[g]=i}return c},stringify:function(a){if(!a)return"";var b=[];for(var c in a)g.call(a,c)&&b.push(c);b.sort();for(var d=[],e=0,f=b.length;f>e;++e){var h=b[e],j=a[h];if(k(j)){j.sort();for(var l=[],m=0,n=j.length;n>m;++m)l.push(i(h)+"="+i(j[m]));d.push(l.join("&"))}else d.push(i(h)+"="+i(j))}return d.join("&")}},o=function(a){if("undefined"==typeof a)throw new TypeError("The RNode Constructor Need A Value.");this.value=a,this.params={},this.callbacks=null,this.before=null,this.after=null,this._children=[],this._parent=null},p=o.prototype;p.children=function(a){return"undefined"==typeof a?this._children:(a instanceof o?this._children.push(a):utils.isArray(a)&&(this._children=this.children.concat(a)),this)},p.parent=function(a){return"undefined"==typeof a?this._parent:(a instanceof o&&(this._parent=a),this)};var q=(document.location,"undefined"!=typeof window.history),r={listeners:null,history:!1,init:function(b){return this.history="history"===b,this.history&&q?window.onpopstate=a:window.onhashchange=a,this},add:function(a){return this.listeners||(this.listeners=[]),this.listeners.push(a),this},setHash:function(a){return window.location.hash="/"===a[0]?a:"/"+a,this},setHashHistory:function(a){history.pushState({},document.title,a),window.onpopstate()}},s={mode:"hashbang",notFound:!1,always:!1,on:!1,before:!1,after:!1},t=exports.Router=function(a){if(a=a||{},!(this instanceof t))return new t(a);var b=new o("");this.routeTree=c(b,a),this.options={},this.configure(s)},u=t.prototype;u.configure=function(a){return a=a||{},this.options=m(this.options,a),this},u.init=function(a){a=a||{};var b=this;return this.configure(a),this.handler=function(a){var c=a&&a.newURL||window.location.hash,d=c.replace(/.*#/,"");b.dispatch("/"===d.charAt(0)?d:"/"+d)},r.init(this.options.mode).add(this.handler),this.handler(),this},u.mount=function(a,d){return""!==a&&"/"===a[0]&&(a=a.slice(1)),c(b(this.routeTree,a),d),this},u.on=u.route=function(a,c){""!==a&&"/"===a[0]&&(a=a.slice(1));var d=b(this.routeTree,a);return d.callbacks=d.callbacks||[],k(c)?d.callbacks=d.callbacks.concat(c):l(c)&&d.callbacks.push(c),this},u.add=function(){},u.map=function(){},u.redirect=function(a){return r.setHash(a),this},u.before=function(){},u.after=function(){},u.dispatch=function(a){var b=this.routeTree,c=a,d=a.indexOf("?"),f=-1===d?"":a.slice(d+1);a=-1===d?a:a.slice(0,d);var g={uri:c,path:a,query:n.parse(f)};"/"===a&&(a="");var h=e(b,a),i=h[0];if(g.params=h[1],null!==i){if(!k(i))throw new TypeError("callbacks must be an array type");for(var j=0,l=i.length;l>j;++j)i[j].call(this,g)}else this.options.notFound&&this.options.notFound(g);return this},u.setRoute=function(a){r.setHashHistory(a)}});
//# sourceMappingURL=spa-router.min.map